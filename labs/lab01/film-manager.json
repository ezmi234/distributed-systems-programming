{
  "$schema": "http://json-schema.org/draft-07/schema",
  "$id": "film-manager.json",

  "definitions": {
    "user":  {
      "type": "object",
      "properties": {
        "id": {"type": "string"},
        "name": {"type": "string"},
        "email": {"type": "string", "format": "email"},
        "password": {"$ref": "#definitions/password"}
      },
      "required": ["id", "email", "password"]
    },
    "film":{
      "type": "object",
      "properties": {
        "id": {"type": "string"},
        "title": {"type": "string"},
        "owner": {"type": "string"},
        "private": {"type": "boolean"}
      }, 
      "if": {
        "properties": {
          "private": {
            "const": true
          }
        }
      },
      "then": {
        "properties": {
          "watchDate": {"$ref": "#definitions/date"},
          "rating": {"$ref": "#definitions/rating"},
          "favorite": {"type": "boolean", "default": false}
        }
      },
      "required": ["id", "title", "owner", "private"] 
    },
    "review":{
      "type": "object",
      "properties": {
        "filmId": {"type": "string"},
        "reviewerId": {"type": "string"},
        "completed": {"type": "boolean"}
      },
      "if": {
        "properties": {
          "completed": {
            "const": true
          }
        }
      },
      "then": {
        "properties": {
          "reviewDate": {"$ref": "#definitions/date"}, 
          "rating": {"$ref": "#definitions/rating"},
          "review": {"type": "string", "maxLength": 1000}
        }
      },
      "required": ["filmId", "reviewerId", "completed"]
    },
    "password": {"type": "string", "minLength": 6, "maxLength": 20 },
    "rating": {"type": "integer", "minimum": 0, "maximum": 10 },
    "date": {"type": "string", "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}$"}
  }
}
